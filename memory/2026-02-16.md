# 2026-02-16 - Polymarket Bot Fixes

## Major Issues Fixed

### 1. Redemption Contract Bug
- **Problem:** Redemption was using `NEG_RISK_CTF` (0xC5d5...) instead of `STANDARD_CTF` (0x4D97...)
- **Symptom:** "missing revert data" errors, redemptions failing
- **Fix:** Updated `src/redemption.ts` to use correct contract for BTC 5-min markets
- **Commit:** `b70a694`

### 2. RPC Strategy
- Split RPCs by operation type:
  - **Reads** (balance, payout checks): Public RPCs with parallel race
  - **Writes** (redemption txs): Premium RPCs first (Alchemy → Tatum → public fallback)
- Alchemy rate limits were causing tx drops

### 3. Over-Betting / Balance Tracking Bug
- **Problem:** Bot was betting % of growing balance without cap
- **Symptom:** Wallet dropped from ~$180 to ~$70 in one session
- **Root cause:** When winning, balance grew → bet sizes grew → losses hit hard
- **Fix:** Added max bet cap = 42% of available budget
- **Commits:** `917c3ec`, `a0aa336`, `3ee44d2`

## Configuration Changes
- Max bet cap: 42% of **available budget** (not allocation)
- With $30 budget → max $12.60 per bet
- Two live strategies: vol-regime + ensemble

## Wallet Status (End of Day)
- USDC: ~$75.40
- Started day: ~$180
- Lost ~$110 to over-betting before fix was applied

## Lessons Learned
- Always cap bet sizes to prevent compounding losses
- CTF contract addresses differ between market types (negRisk vs standard)
- Premium RPCs essential for write operations on Polygon
