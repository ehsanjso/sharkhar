# Proactive Coder - Session 1 Plan
**Date:** 2026-02-19 7:00 PM EST  
**Time Limit:** 45 minutes  
**Goal:** Planning + Setup

---

## Task Selected: Smart Cron Job Optimizer Script

### Why This Task?
- Previous `cron-audit.sh` only showed suggestions, didn't apply changes
- Existing `switch-cron-model.js` used hardcoded job list (not dynamic)
- Cron optimization was "blocked" - but only needed a better tool
- High-impact: Pill Reminder (and future simple jobs) can save costs

### What Was Built

**New Script:** `~/clawd/scripts/cron-optimize.sh`

Features:
- **Smart detection**: Uses pattern matching to classify jobs
  - Simple tasks → can switch to Haiku (cheaper)
  - Complex tasks → keep on Sonnet (smarter)
- **Dry run by default**: Safe preview before changes
- **Backup creation**: Saves jobs.json before modifying
- **One-command solution**: `./cron-optimize.sh --apply`

### Detection Logic

**Safe for Haiku (simple tasks):**
- reminder, backup, prune, cleanup, status, check, monitor, alert, ping, health

**Keep on Sonnet (complex tasks):**
- report, analysis, analyze, research, digest, code, review, proactive, strategy, trading, market, polymarket, airdrop

### Current State (Feb 19)

Running `./cron-optimize.sh` shows:
```
Total jobs:        17
Already optimized: 5 (Morning Brief, Clawdbot Backup, Session Pruning, NFT Price Monitor, Claude Quota Monitor)
Can switch:        1 (Pill Reminder)
Keep complex:      11 (correctly classified)
```

### Files Changed
1. Created `scripts/cron-optimize.sh` (new)
2. Updated `scripts/README.md` (added docs)
3. Updated `memory/builds/backlog.md` (changed status to "ready")

---

## Session 2 Handoff

### What's Ready
- Script is complete and tested
- Documentation updated
- Ready to apply from main session

### Session 2 Should
1. Verify no regressions in script
2. Consider: add `--force` flag for jobs marked "review"?
3. Or pick a new task from backlog

### To Apply Changes (Main Session)
```bash
cd ~/clawd/scripts
./cron-optimize.sh --apply
clawdbot gateway restart
```

---

## Time Log
- 7:00 PM - Started, read context
- 7:08 PM - Identified task: improve cron optimization tooling
- 7:15 PM - Found issue: `switch-cron-model.js` uses hardcoded list
- 7:20 PM - Created `cron-optimize.sh` with smart detection
- 7:28 PM - Fixed jq parsing issue (multiline JSON in jobs)
- 7:35 PM - Script working, tested successfully
- 7:40 PM - Updated docs and backlog
- 7:45 PM - Committing and documenting

---

## Summary for Ehsan

Created **`cron-optimize.sh`** - a smart one-command cron cost optimizer.

**Before:** Multiple scripts, hardcoded job lists, manual commands needed
**After:** `./cron-optimize.sh --apply` handles everything

Currently 1 job (Pill Reminder) can switch to Haiku for ~10x cost savings on that job.

**To apply:** Run from Telegram main session:
```
cd ~/clawd/scripts && ./cron-optimize.sh --apply && clawdbot gateway restart
```
